<app-table-layout [loading]="loading.getProducts" [tableSetting]="tableSetting" (reset)="onReset()"
  (refresh)="onRefresh()">
  <!-- #region filter -->
  <ng-container filter>
    <div class="main-page-layout-fi">
      <label class="main-label text-sm">Product Name</label>
      <mat-form-field>
        <input matInput [(ngModel)]="params.name" placeholder="Enter Product Name"
          (ngModelChange)="onChangeProductName($event)" />
        <button mat-icon-button matSuffix matTooltip="Clear" matTooltipPosition="above"
          (click)="onClearFilter('name', $event)">
          <mat-icon aria-hidden="false" aria-label="Cancel" fontIcon="cancel"></mat-icon>
        </button>
      </mat-form-field>
    </div>

    <div class="main-page-layout-fi">
      <label class="main-label text-sm">Category</label>
      <mat-form-field *ngIf="categories.length">
        <mat-select [(ngModel)]="params.category" (ngModelChange)="onChangeCategory($event)"
          placeholder="Select Category">
          <ng-container *ngFor="let category of categories">
            <mat-option [value]="category.code">{{category.label}}</mat-option>
          </ng-container>
        </mat-select>
        <button mat-icon-button matSuffix matTooltip="Clear" matTooltipPosition="above"
          (click)="onClearFilter('category', $event)">
          <mat-icon aria-hidden="false" aria-label="Cancel" fontIcon="cancel"></mat-icon>
        </button>
      </mat-form-field>
    </div>

    <div class="main-page-layout-fi" [ngClass]="{'main-disabled': !params.category}">
      <label class="main-label text-sm">Type</label>
      <mat-form-field>
        <mat-select [(ngModel)]="params.type" (ngModelChange)="onChangeFilter()" placeholder="Select Type">
          <ng-container *ngFor="let type of typesForSelect">
            <mat-option [value]="type.code">{{type.label}}</mat-option>
          </ng-container>
        </mat-select>
        <button mat-icon-button matSuffix matTooltip="Clear" matTooltipPosition="above"
          (click)="onClearFilter('type', $event)">
          <mat-icon aria-hidden="false" aria-label="Cancel" fontIcon="cancel"></mat-icon>
        </button>
      </mat-form-field>
    </div>
  </ng-container>
  <!-- #endregion filter -->

  <!-- #region filter right -->
  <ng-container filter-right>
    <button mat-icon-button (click)="onClickAddProduct()" matTooltip="Add Product" matTooltipPosition="above">
      <mat-icon aria-hidden="false" aria-label="Add Circle" fontIcon="add_circle"></mat-icon>
    </button>
  </ng-container>
  <!-- #endregion filter right -->

  <!-- #region table -->
  <ng-container table>
    <table *ngIf="productData" mat-table [dataSource]="productData" mat-virtual-scroll>

      <ng-container *ngFor="let header of tableHeaders;let index = index;">
        <ng-container [matColumnDef]="header.field">
          <th mat-header-cell *matHeaderCellDef
            [style]="'--mat-mdc-header-cell:' + (header?.width ? (header.width + 'px;') : 'auto;')" class="main-ap-hd">
            <ng-container [ngSwitch]="header.fieldType">
              <ng-container *ngSwitchCase="'select'">
                <ng-container *ngIf="!disable.action()">
                  <mat-checkbox class="example-margin" [(ngModel)]="checkAll"
                    (ngModelChange)="onClickSelectAll($event)"></mat-checkbox>
                </ng-container>
              </ng-container>

              <ng-container *ngSwitchDefault>
                <app-sort-header [header]="header" (headerChange)="onClickSortHeader(index, $event)"></app-sort-header>
              </ng-container>
            </ng-container>
          </th>

          <td mat-cell *matCellDef="let element">
            <ng-container [ngSwitch]="header.fieldType">
              <ng-container *ngSwitchCase="'view'">
                <span class="underline text-sky-600 cursor-pointer"
                  (click)="onOpenAddProductDialog('VIEW', element)">{{element[header.field]}}</span>
              </ng-container>

              <ng-container *ngSwitchCase="'dateTime'">
                {{element[header.field] | appDateTimePipe}}
              </ng-container>

              <ng-container *ngSwitchCase="'select'">
                <mat-checkbox class="example-margin" [(ngModel)]="element.select"
                  (ngModelChange)="onClickSelectProduct($event, element)"></mat-checkbox>
              </ng-container>

              <ng-container *ngSwitchCase="'action'">
                <button mat-icon-button (click)="onClickUpdateProduct(element)">
                  <mat-icon aria-hidden="false" aria-label="Edit Note" fontIcon="edit_note"></mat-icon>
                </button>
              </ng-container>

              <ng-container *ngSwitchDefault>
                {{element[header.field]}}
              </ng-container>
            </ng-container>
          </td>
        </ng-container>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </ng-container>
  <!-- #endregion table -->

  <!-- #region footer -->
  <ng-container button-right-ft>
    <button [ngClass]="{'main-disabled': disable.delete()}" class="main-btn-war" mat-flat-button
      (click)="onClickDeleteProduct()">
      Delete
    </button>
  </ng-container>
  <!-- #endregion footer -->
</app-table-layout>